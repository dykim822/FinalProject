<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="reservationns">
	
	<!-- 타세요 상세보기에서 신청버튼 클릭시  -->
	<insert id="insert" parameterType="reservation">
		insert into reservation values
		((SELECT NVL(MAX(RSV_num), 0) + 1 as RSV_num FROM reservation), 'Y', 'N', #{MB_num}, #{CP_num})
	</insert>
	
	<!-- 타세요 상세보기 하단 신청 현황  -->
	<select id="reservationList" parameterType="reservation" resultType="reservation">
		select * from reservation where CP_num=#{CP_num} order by RSV_num
	</select>
	
	<select id="getTotal" parameterType="reservation" resultType="integer">
		select count(*) from reservation
	</select>
	
	<!-- 타세요 신청현황(드라이버) 매칭여부 "수락" 버튼 -->
	<update id="updateAccept" parameterType="reservation">
		update reservation set RSV_mConfirm='Y' where CP_num=#{CP_num} and MB_num=#{MB_num}
	</update>
	
	<!-- 타세요 신청현황(드라이버) 매칭여부 "거절" 버튼 -->
	<update id="updateDenial" parameterType="reservation">
		update reservation set RSV_confirm='N' where CP_num=#{CP_num} and MB_num=#{MB_num}
	</update>

</mapper>